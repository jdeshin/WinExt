// Нижеследующий текст можно вставить в модуль обработки
//

// COM-объект WinExt
Перем _winExt;

// Эмулирует нажатие клавиш на клавиатуре
//
Процедура НажатьКлавиши(СтрокаКлавиши) Экспорт
	
	_winExt.OriginalSendKeys(СтрокаКлавиши);
	
КонецПроцедуры

// Эмулирует нажатие Ctrl + G
//
Процедура НажатьCtrlG() Экспорт
	
	_winExt.SendCtrlG();
	
КонецПроцедуры

// Эмулирует нажатие Ctrl + F
//
Процедура НажатьCtrlF() Экспорт
	
	_winExt.SendCtrlF();
	
КонецПроцедуры

// Эмулирует нажатие Ctrl + A
//
Процедура НажатьCtrlA() Экспорт
	
	_winExt.SendCtrlA();
	
КонецПроцедуры

// Эмулирует нажатие Ctrl + O
//
Процедура НажатьCtrlO() Экспорт
	
	_winExt.SendCtrlO();
	
КонецПроцедуры

// Эмулирует нажатие Ctrl + Q
//
Процедура НажатьCtrlQ() Экспорт
	
	_winExt.SendCtrlQ();
	
КонецПроцедуры

// Эмулирует нажатие Ctrl + T
//
Процедура НажатьCtrlT() Экспорт
	
	_winExt.SendCtrlT();
	
КонецПроцедуры

// Эмулирует нажатие [
//
Процедура НажатьКвадратнуюСкобкуЛевую() Экспорт
	
	_winExt.SendCtrlSquareBracketLeft();
	
КонецПроцедуры

// Эмулирует нажатие ]
//
Процедура НажатьКвадратнуюСкобкуПравую() Экспорт
	
	_winExt.SendCtrlSquareBracketRight();
	
КонецПроцедуры

// Эмулирует нажатие Ctrl + Insert
//
Процедура НажатьCtrlIns() Экспорт
	
	_winExt.SendCtrlInsert();
	
КонецПроцедуры

// работа с мышью

// Эмулирует нажатие левой кнопки мыши
//
Процедура НажатьЛевуюКнопкуМыши(X, Y) Экспорт
	
	_winExt.LeftMouseClick(X, Y);
	
КонецПроцедуры

// Эмулирует нажатие правой кнопки мыши
//
Процедура НажатьПравуюКнопкуМыши(X, Y) Экспорт
	
	_winExt.RightMouseClick(X, Y);
	
КонецПроцедуры

// Эмулирует нажатие средней кнопки мыши
//
Процедура НажатьСреднююКнопкуМыши(X, Y) Экспорт
	
	_winExt.MiddleMouseClick(X, Y);
	
КонецПроцедуры

// Устанавливает текущее положение курсора мыши
//
Процедура УстановитьТекущуюПозициюКурсора(X, Y) Экспорт
	
	_winExt.SetMouseCursorPosition(X, Y);
	
КонецПроцедуры

// Возвращает текущее положение курсора мыши
//
Функция ПолучитьТекущуюПозициюКурсора() Экспорт
	
	_winExt.GetMouseCursorPosition();
	ПозицияКурсора = Новый Структура;
	ПозицияКурсора.Вставить("X", _winExt.MousePositionX);
	ПозицияКурсора.Вставить("Y", _winExt.MousePositionY); 
	
	Возврат Новый ФиксированнаяСтруктура(ПозицияКурсора);
	
КонецФункции

// работа с экраном

// Получает разрешение экрана
//
Функция ПолучитьРазрешениеЭкрана(НомерЭкрана) Экспорт
	
	_winExt.GetScreenResolution(НомерЭкрана);
	РазрешениеЭкрана = Новый Структура;
	РазрешениеЭкрана.Добавить("Высота", _winExt.ScreenResolutionHeight);
	РазрешениеЭкрана.Добавить("Ширина", _winExt.ScreenResolutionWidth);
	
	Возврат Новый ФиксированнаяСтруктура(РазрешениеЭкрана);
	
КонецФункции

// Ищет фрагмент изображения. Если фрагмент найден - возвращает координаты, в противном случае - неопределено
//
Функция НайтиФрагмент(ИмяФайла) Экспорт
	
	_winExt.FindScreenFragment(ИмяФайла);
	
	// Надо поправить ошибку
	Если Не _winExt.IsScreenFragmentFound Тогда
		Возврат Неопределено;
	КонецЕсли;
	
	Фрагмент = Новый Структура;
	Фрагмент.Вставить("Лево", _winExt.ScreenFragmentLeft);
	Фрагмент.Вставить("Верх", _winExt.ScreenFragmentTop);
	Фрагмент.Вставить("Высота", _winExt.ScreenFragmentHeight);
	Фрагмент.Вставить("Ширина", _winExt.ScreenFragmentWidth);
	
	Возврат Новый ФиксированнаяСтруктура(Фрагмент);
	
КонецФункции

//работа с текстом

// Возвращает текст поля
//
Функция ПолучитьТекстПоля() Экспорт
	
	Возврат _winExt.GetModuleText();
	
КонецФункции

// работа с окном

// Запоминает текущее окно
//
Процедура ЗапомнитьТекущееОкно() Экспорт
	
	_winExt.GetLinkToCurWindow();
	
КонецПроцедуры

// Активирует запомненное окно
//
Процедура АктивироватьЗапомненноеОкно() Экспорт
	
	_winExt.WndActivate();
	
КонецПроцедуры

// Активирует окно по заголовку. В случае успеха возвращает Истина, иначе - Ложь
//
Функция АктивироватьОкноПоЗаголовку(Заголовок) Экспорт
	
	Возврат _winExt.SwitchToWin(Заголовок);
	
КонецФункции

// Прерывает выполнение на указанное количество миллисекунд
//
Процедура Подождать(Таймаут) Экспорт
	
	_winExt.Sleep(Таймаут);
	
КонецПроцедуры

// Инициализация переменных
_winExt = Новый COMОбъект("WinExtCOM.WinExtCOM");

// Ваш код...
//УстановитьТекущуюПозициюКурсора(500, 500);
//Подождать(1000);
//УстановитьТекущуюПозициюКурсора(300, 300);
//НажатьЛевуюКнопкуМыши(400, 400);
